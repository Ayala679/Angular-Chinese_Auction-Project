<p-toast />

<form [formGroup]="registerForm" (ngSubmit)="onSubmit()" class="card flex flex-col gap-4 p-4">
    <h2>Register</h2>

    <div class="flex flex-col gap-1">
        <p-floatlabel variant="in">
            <input pInputText id="email" formControlName="Email" autocomplete="off" [invalid]="isInvalid('Email')" />
            <label for="email">Email</label>
        </p-floatlabel>
        @if (isInvalid('Email')) {
        <p-message severity="error" size="small" variant="simple">
            @if (registerForm.get('Email')?.hasError('required')) { Email is required. }
            @if (registerForm.get('Email')?.hasError('email')) { Please enter a valid email. }
        </p-message>
        }
    </div>

    <div class="flex flex-col gap-1">
        <p-floatlabel variant="in">
            <input pInputText id="fname" formControlName="First_name" [invalid]="isInvalid('First_name')" />
            <label for="fname">First Name</label>
        </p-floatlabel>
        @if (isInvalid('First_name')) {
        <p-message severity="error" size="small" variant="simple">First Name is required.</p-message>
        }
    </div>

    <div class="flex flex-col gap-1">
        <p-floatlabel variant="in">
            <input pInputText id="lname" formControlName="Last_name" [invalid]="isInvalid('Last_name')" />
            <label for="lname">Last Name</label>
        </p-floatlabel>
        @if (isInvalid('Last_name')) {
        <p-message severity="error" size="small" variant="simple">Last Name is required.</p-message>
        }
    </div>

    <div class="flex flex-col gap-1">
        <p-floatlabel variant="in">
            <input pInputText type="password" id="pass" formControlName="Password" [invalid]="isInvalid('Password')" />
            <label for="pass">Password</label>
        </p-floatlabel>
        @if (isInvalid('Password')) {
        <p-message severity="error" size="small" variant="simple">Password must be at least 6 characters.</p-message>
        }
    </div>

    <div class="flex flex-col gap-1">
        <p-floatlabel variant="in">
            <input pInputText type="password" id="confirmPass" formControlName="ConfirmPassword"
                [invalid]="isInvalid('ConfirmPassword') || (registerForm.get('ConfirmPassword')?.touched && registerForm.get('Password')?.value !== registerForm.get('ConfirmPassword')?.value)" />
            <label for="confirmPass">Confirm Password</label>
        </p-floatlabel>

        @if (registerForm.get('ConfirmPassword')?.touched || registerForm.dirty) {
        @if (registerForm.get('ConfirmPassword')?.hasError('required')) {
        <p-message severity="error" size="small" variant="simple">Confirmation is required.</p-message>
        } @else if (registerForm.get('Password')?.value !== registerForm.get('ConfirmPassword')?.value) {
        <p-message severity="error" size="small" variant="simple">Passwords do not match.</p-message>
        }
        }
    </div>

    <div class="flex flex-col gap-1">
        <p-floatlabel variant="in">
            <p-inputmask id="phone" formControlName="Phone" [invalid]="isInvalid('Phone')" mask="999-999-9999" />
            <label for="phone">Phone (Optional)</label>
        </p-floatlabel>

        @if (isInvalid('Phone')) {
        <p-message severity="error" size="small" variant="simple">Invalid phone number.</p-message>
        }
    </div>

    <button pButton type="submit" label="Submit" [disabled]="registerForm.invalid"></button>
</form>